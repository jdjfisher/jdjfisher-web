---
import ProjectPageLayout from '../../layouts/ProjectPageLayout.astro';
import { z } from 'zod';
import Placeholder from '../../components/Placeholder.astro';
import RichText from '../../components/RichText';
import { getCollection } from 'astro:content';
import { getEntry } from 'astro:content';

export async function getStaticPaths() {
  const projects = await getCollection('projects');

  return projects.map((project) => ({
    params: { slug: project.id },
  }));
}

const slug = z.string().parse(Astro.params.slug);

const project = await getEntry('projects', slug)!;
---

<ProjectPageLayout project={project.data}>
  <!-- @ts-ignore -->
  {project.content ? <RichText text={project.content} /> : <Placeholder />}
</ProjectPageLayout>
